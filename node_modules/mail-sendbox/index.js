var net                 = require('net');
var sendbox_commands    = require('./lib/socket-command');

module.exports.start = function( port ) {

    net.createServer( function(socket) {
        socket.getSendboxCommands( ).helloMessage( );
        socket.on('data', function( data ) {
            socket.getSendboxCommands().readData( data.toString() );
        });
        socket.on('end', function() {
            socket.getSendboxCommands().processData( );
            socket.getSendboxCommands( ).closeConnection( );
        });
        socket.on('error', function(error) {
            console.log( error ); //TODO log error
        });
    } ).listen(port, '127.0.0.1');

};